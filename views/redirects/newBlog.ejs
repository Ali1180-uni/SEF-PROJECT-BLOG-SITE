<% layout('/includes/boilerplate') %>
<header>
  <h1>New Blog</h1>
  <form action="/blogs" class="needs-validation" method="POST" novalidate style="width:100%; max-width:760px;">
    <div class="mb-3">
      <label for="topic" class="form-label">Topic</label>
      <input type="text" class="form-control" id="topic" name="topic" required>
      <div class="invalid-feedback">Please enter a topic.</div>
    </div>

    <div class="mb-3">
      <label for="title" class="form-label">Title</label>
      <input type="text" class="form-control" id="title" name="title" required>
      <div class="invalid-feedback">Please enter a title.</div>
    </div>

    <div class="mb-3">
      <label for="content" class="form-label">Content</label>
      <div id="editor" style="height: 300px; background: white;"></div>
      <textarea class="form-control" id="content" name="content" style="display:none;" required></textarea>
      <div class="invalid-feedback">Please enter blog content.</div>
    </div>

    <button type="submit" class="btn btn-cta">Submit</button>
  </form>

  <!-- Quill.js CSS -->
  <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
  
  <!-- Quill.js JS -->
  <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
  
  <script>
    // Initialize Quill editor
    var quill = new Quill('#editor', {
      theme: 'snow',
      placeholder: 'Write your blog content here...',
      modules: {
        toolbar: [
          [{ 'header': [1, 2, 3, false] }],
          ['bold', 'italic', 'underline', 'strike'],
          [{ 'list': 'ordered'}, { 'list': 'bullet' }],
          [{ 'color': [] }, { 'background': [] }],
          ['link', 'blockquote', 'code-block'],
          ['clean']
        ]
      }
    });

    // Sync Quill content to hidden textarea on form submit
    document.querySelector('form').onsubmit = function() {
      var content = document.querySelector('#content');
      content.value = quill.root.innerHTML;
      return true;
    };
  </script>
  
  <script src="/JS/form-validation.js"></script>
</header>